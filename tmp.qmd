---
title: "tmp"
execute:
  cache: true
---

## EM algorithm

```{r}
library(mclust)
data = faithful
(data = data[,1])  # just cluster the 1st dimension
```

```{r}
set.seed(123)
K=2
n=length(data)
z=matrix(0, n, K)
id=sample(1:K, n, replace=TRUE)
for(i in 1:n) z[i,id[i]]=1
z[1:3, ]
#[,1] [,2]
#[1,]    1    0  # ob 1 assigned to class 1
#[2,]    0    1  # ob 2 assigned to class 2
#[3,]    1    0  # ob 3 assigned to class 1
```

```{r}
tmp=mstep(modelName="V", data, z)
summary(tmp)
```

```{r}
# mixigin weight
apply(z, 2, mean) # the ratio in the number of observations assigned to each category
tmp$parameters$pro
```

```{r}
# mu_1, mu_2 
sum(z[,1]*data)/sum(z[,1]) # the average value for each category
sum(z[,2]*data)/sum(z[,2])
tmp$parameters$mean
```
